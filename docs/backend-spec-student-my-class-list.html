<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Student 마이클래스 목록 — 백엔드 기능 정의</title>
  <style>
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; margin: 0; padding: 32px; max-width: 900px; margin-left: auto; margin-right: auto; background: #fff; color: #1f2937; line-height: 1.6; }
    h1 { font-size: 1.5rem; margin-top: 0; border-bottom: 2px solid #2563eb; padding-bottom: 8px; }
    h2 { font-size: 1.2rem; margin-top: 28px; color: #374151; }
    h3 { font-size: 1rem; margin-top: 20px; color: #4b5563; }
    p { margin: 8px 0; }
    table { border-collapse: collapse; width: 100%; font-size: 0.9rem; margin: 12px 0; }
    th, td { border: 1px solid #e5e7eb; padding: 10px 12px; text-align: left; }
    th { background: #f9fafb; font-weight: 600; }
    pre, code { background: #f3f4f6; padding: 2px 6px; border-radius: 4px; font-size: 0.875rem; }
    pre { padding: 12px; overflow-x: auto; }
    ul { margin: 8px 0; padding-left: 24px; }
    li { margin: 4px 0; }
    hr { border: none; border-top: 1px solid #e5e7eb; margin: 24px 0; }
    .meta { color: #6b7280; font-size: 0.9rem; margin-bottom: 20px; }
    .copy-hint { font-size: 0.8rem; color: #9ca3af; margin-top: 24px; }
  </style>
</head>
<body>
  <h1>Student 마이클래스 목록 — 백엔드 기능 정의</h1>
  <p class="meta"><strong>대상 화면</strong>: Student 마이클래스 목록 (<code>/student/my-classes</code>) · <strong>목적</strong>: 백엔드 개발자가 목록 API·데이터·권한·비즈니스 규칙 구현 시 참고</p>

  <h2>1. 화면 요약</h2>
  <table>
    <tr><th>항목</th><th>내용</th></tr>
    <tr><td><strong>경로</strong></td><td><code>/student/my-classes</code> (Student), <code>/master/my-classes</code> (Master 동일 구조)</td></tr>
    <tr><td><strong>역할</strong></td><td>Student, Master (본인 수강 클래스만)</td></tr>
    <tr><td><strong>주요 동작</strong></td><td>내가 수강 중인 클래스 카드 목록 조회, 상태별 필터, 카드 클릭 시 상세 이동, 초대코드 등록</td></tr>
  </table>

  <h2>2. API 명세</h2>
  <h3>2.1 내 수강 클래스 목록 조회 (신규 API 권장)</h3>
  <p><strong>현재 프론트 동작</strong>: 기관별 클래스 전체(<code>GET /class/organization/list</code>) + 클라이언트 localStorage로 “내 클래스” 필터링. → 백엔드에서 “내 수강 클래스” 전용 API 제공 시 단일 호출로 처리 가능.</p>
  <table>
    <tr><th>항목</th><th>내용</th></tr>
    <tr><td><strong>메서드·경로</strong></td><td><code>GET /class/my-list</code> 또는 <code>GET /enrollment/my-classes</code></td></tr>
    <tr><td><strong>인증</strong></td><td>필수. Bearer Token. 요청 사용자 = 수강 대상(Student/Master).</td></tr>
    <tr><td><strong>권한</strong></td><td>Student, Master만 호출 가능. Admin 불가.</td></tr>
  </table>

  <h3>Request (Query Parameters)</h3>
  <table>
    <tr><th>파라미터</th><th>타입</th><th>필수</th><th>기본값</th><th>설명</th></tr>
    <tr><td>page</td><td>number</td><td>N</td><td>1</td><td>페이지 번호</td></tr>
    <tr><td>pageSize</td><td>number</td><td>N</td><td>6</td><td>페이지당 건수</td></tr>
    <tr><td>status</td><td>string</td><td>N</td><td>all</td><td>all | eligible | participating | completed | ended</td></tr>
  </table>
  <p><strong>status</strong>: all(전체), eligible(참여가능), participating(참여중), completed(이수완료), ended(종료, 수강기간 만료)</p>

  <h3>Response (200 OK)</h3>
  <pre>{
  "list": MyClassListItemDto[],
  "totalCount": number
}</pre>

  <h3>MyClassListItemDto (목록 1건)</h3>
  <table>
    <tr><th>필드</th><th>타입</th><th>필수</th><th>설명</th></tr>
    <tr><td>classId</td><td>number</td><td>Y</td><td>클래스 ID</td></tr>
    <tr><td>title</td><td>string</td><td>Y</td><td>클래스명</td></tr>
    <tr><td>description</td><td>string</td><td>N</td><td>클래스 설명</td></tr>
    <tr><td>thumbnailUrl</td><td>string</td><td>N</td><td>썸네일 URL</td></tr>
    <tr><td>participationPeriod</td><td>object</td><td>Y</td><td>수강기간 (startDate, endDate)</td></tr>
    <tr><td>enrollmentStatus</td><td>string</td><td>Y</td><td>eligible | participating | completed</td></tr>
    <tr><td>curriculumCount</td><td>number</td><td>N</td><td>세션 수</td></tr>
    <tr><td>duration</td><td>string</td><td>N</td><td>예상 소요시간</td></tr>
    <tr><td>isPrivate</td><td>boolean</td><td>N</td><td>비공개 클래스 여부</td></tr>
  </table>

  <h3>에러 응답</h3>
  <table>
    <tr><th>HTTP</th><th>상황</th></tr>
    <tr><td>401</td><td>미인증</td></tr>
    <tr><td>403</td><td>권한 없음</td></tr>
  </table>

  <hr />

  <h2>3. 비즈니스 규칙</h2>
  <h3>3.1 “내 수강 클래스” 범위</h3>
  <ul>
    <li>수강 등록(enrollment)이 생성된 클래스 (주문 완료 등)</li>
    <li>초대 수락으로 참여가 등록된 클래스</li>
    <li>기관·라이선스로 자동 등록된 클래스 (정책에 따라)</li>
  </ul>
  <p>→ 수강(enrollment) 테이블 기준으로 현재 사용자 + classId 조인해 목록 생성.</p>

  <h3>3.2 표시 상태(displayStatus) 규칙</h3>
  <table>
    <tr><th>enrollmentStatus</th><th>수강기간</th><th>화면 표시</th></tr>
    <tr><td>eligible</td><td>기간 내</td><td>참여가능</td></tr>
    <tr><td>eligible</td><td>만료</td><td>종료</td></tr>
    <tr><td>participating</td><td>기간 내</td><td>참여중</td></tr>
    <tr><td>participating</td><td>만료</td><td>종료</td></tr>
    <tr><td>completed</td><td>기간 내</td><td>이수완료</td></tr>
    <tr><td>completed</td><td>만료</td><td>종료</td></tr>
  </table>

  <h3>3.3 상태 값 정의</h3>
  <table>
    <tr><th>값</th><th>의미</th></tr>
    <tr><td>eligible</td><td>수강 등록됨. 아직 “세션 시작” 전.</td></tr>
    <tr><td>participating</td><td>최소 1회 세션 참여. 이수 조건 미달.</td></tr>
    <tr><td>completed</td><td>이수 조건 충족. 이수증 다운로드 가능.</td></tr>
  </table>

  <h2>4. 페이지네이션·정렬</h2>
  <table>
    <tr><th>항목</th><th>규칙</th></tr>
    <tr><td>페이지네이션</td><td>page, pageSize 지원. 기본 pageSize=6.</td></tr>
    <tr><td>정렬</td><td>기본: 수강기간 시작일 내림차순 또는 최근 참여일 내림차순.</td></tr>
  </table>

  <h2>5. 통계(선택)</h2>
  <p><strong>참여중인 클래스 수</strong>: enrollmentStatus = participating 이고 수강기간 내인 건수. 목록 API 응답에 summary.activeCount 포함 또는 별도 summary API.</p>

  <h2>6. 연관 API·플로우</h2>
  <table>
    <tr><th>플로우</th><th>연동</th></tr>
    <tr><td>초대코드 등록</td><td>초대 수락 API 호출 후 목록 API에 새 항목 포함</td></tr>
    <tr><td>주문 완료</td><td>수강 등록 생성 후 목록 API에 새 항목 포함</td></tr>
    <tr><td>마이클래스 상세</td><td>GET /class/{classId} (기존 API)</td></tr>
  </table>

  <h2>7. 현재 프론트 데이터 소스(참고)</h2>
  <p>목록: useClasses(organizationId) → GET /class/organization/list + localStorage 필터. 상태: myClassStatus, participatingClasses (localStorage). 백엔드 GET /class/my-list 제공 시 프론트는 해당 API 1회 호출로 교체 가능.</p>

  <h2>8. 체크리스트 (백엔드 구현 시)</h2>
  <ul>
    <li>수강(enrollment) 도메인·테이블 및 “내 수강 클래스” 조회 가능 여부</li>
    <li>GET /class/my-list 엔드포인트 및 page, pageSize, status 구현</li>
    <li>응답 DTO에 participationPeriod, enrollmentStatus, curriculumCount, isPrivate 포함</li>
    <li>status=ended 시 수강기간 만료 필터</li>
    <li>인증·역할 검증(Student/Master만 허용)</li>
    <li>(선택) 목록 응답에 activeCount 또는 별도 요약 API</li>
  </ul>

  <p class="copy-hint">Google Docs에 넣으려면: 이 페이지를 브라우저에서 연 뒤 전체 선택(Cmd+A) → 복사 → Google Docs에 붙여넣기 하면 서식이 어느 정도 유지됩니다.</p>
</body>
</html>
